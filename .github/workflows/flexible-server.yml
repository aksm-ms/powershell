name: Testing azure mysql deploy action
on:
  push:
    paths: '.github/workflows/flexible-server.yml'
jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [windows-latest]
#         os: [ubuntu-latest, windows-latest,macos-latest]
    steps:
    - name: Checkout code.
      uses: actions/checkout@v2 
      
    - name: Azure login
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
        
    - name: 'Azure Mysql deploy'
      uses: Azure/mysql@v1
      with:
        server-name: ak-flexible-mysql-2.mysql.database.azure.com
        username: aksm
        password: ${{ secrets.MYSQL_FLEXIBLE_PASSWORD }}
        sql-file: ${{github.workspace}}/run-flexible.sql
